# 🚀 PR Automation Script

This repository includes an intelligent PR creation script that automates the entire pull request workflow.

## What It Does

The `create-pr.sh` script automatically:

1. ✅ **Analyzes your branch** - Finds all commits vs base branch
2. ✅ **Discovers documentation** - Looks for PR-X-SUMMARY.md files
3. ✅ **Extracts key content** - Pulls overview, features, checklists
4. ✅ **Generates description** - Creates comprehensive PR description
5. ✅ **Pushes to remote** - Handles both new and existing branches
6. ✅ **Creates the PR** - Uses GitHub CLI with rich formatting
7. ✅ **Opens in browser** - Optionally opens for review

## Installation

### One-Time Setup

```bash
# 1. Make sure GitHub CLI is installed
brew install gh

# 2. Authenticate with GitHub
gh auth login

# 3. Make the script executable (already done)
chmod +x create-pr.sh
```

### Optional: Global Alias

Add to your `~/.zshrc` or `~/.bashrc`:

```bash
# PR creation alias
alias pr="~/Desktop/gauntlet-01/create-pr.sh"
```

Then reload:
```bash
source ~/.zshrc
```

Now you can just type `pr` from anywhere! 🎉

## Usage

### Basic Usage

```bash
# From repository root
./create-pr.sh

# Or if you set up the alias
pr
```

### With Custom Base Branch

```bash
# Create PR against 'develop' instead of 'main'
./create-pr.sh develop

# Or with alias
pr develop
```

## What You'll See

```
╔════════════════════════════════════════════════════════════════════╗
║  PR Creation Script - Pre-flight Checks
╚════════════════════════════════════════════════════════════════════╝

✓ GitHub CLI found
✓ Git repository detected
✓ GitHub CLI authenticated
✓ Feature branch verified
ℹ Current branch: feature/my-awesome-feature
ℹ Base branch: main

╔════════════════════════════════════════════════════════════════════╗
║  Analyzing Branch: feature/my-awesome-feature
╚════════════════════════════════════════════════════════════════════╝

▶ Found 5 commit(s)
▶ Commit history:
  abc1234 feat: Add feature X
  def5678 fix: Fix bug Y
  ...

╔════════════════════════════════════════════════════════════════════╗
║  Looking for PR Documentation
╚════════════════════════════════════════════════════════════════════╝

✓ Found: PR-4-SUMMARY.md
ℹ Detected PR number: #4

╔════════════════════════════════════════════════════════════════════╗
║  Creating Pull Request
╚════════════════════════════════════════════════════════════════════╝

✓ Pull request created successfully!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✨ PR URL: https://github.com/username/repo/pull/5
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Open PR in browser now? [y/N]:
```

## Smart Documentation Discovery

The script intelligently finds your PR documentation:

### Priority 1: PR Number Detection
Extracts PR number from branch name patterns:
- `feature/pr-4-shapes` → Looks for `PR-4-*.md`
- `bugfix/PR-3-cursor-fix` → Looks for `PR-3-*.md`

### Priority 2: Documentation Files
Searches for:
- `PR-X-SUMMARY.md` - Main documentation
- `PR-X-IMPLEMENTATION.md` - Implementation details
- `PR-X-DESCRIPTION.md` - PR description

### Priority 3: Fallback
If no docs found:
- Uses commit messages
- Generates basic description
- Still creates a professional PR

## Generated PR Structure

```markdown
## 📋 Summary
[Extracted from documentation or commits]

## 🎯 PR Checklist
- ✅ Feature 1 implemented
- ✅ Tests passing
- ✅ Documentation updated

## 📁 Files Changed
[Git diff stats]

## 📈 Commits
[Commit history]

## 🧪 Testing Instructions
[Extracted from docs if available]

---
**Generated by:** `create-pr.sh`
**Branch:** `feature/my-feature`
**Base:** `main`
```

## Features

### 🎨 Beautiful Output
- Color-coded messages
- Clear progress indicators
- Professional formatting

### 🧠 Intelligent Content Extraction
- Parses markdown documentation
- Extracts relevant sections
- Maintains formatting

### 🔒 Safe Operations
- Pre-flight checks for all requirements
- Validates branch and auth status
- Prevents PRs from main/master

### ⚡ Fast & Efficient
- Single command execution
- No manual copy-paste
- Opens browser automatically

## Quick Commands Reference

After creating a PR, you can use:

```bash
# View PR in browser
gh pr view 5 --web

# View PR in terminal
gh pr view 5

# Check PR status
gh pr status

# Add reviewers
gh pr edit 5 --add-reviewer username

# Add labels
gh pr edit 5 --add-label bug,enhancement

# Merge PR
gh pr merge 5
```

## Troubleshooting

### "GitHub CLI not installed"
```bash
brew install gh
```

### "GitHub CLI not authenticated"
```bash
gh auth login
```

### "Not in a git repository"
Make sure you're in the repository root or `collabcanvas/` directory.

### "No commits found"
Make sure you have commits in your branch that aren't in main:
```bash
git log main..HEAD
```

## Customization

### Change Default Base Branch
Edit line 26 in `create-pr.sh`:
```bash
BASE_BRANCH="${1:-develop}"  # Use 'develop' instead of 'main'
```

### Change Work Directory
Edit line 27 in `create-pr.sh`:
```bash
WORK_DIR="your-directory-name"
```

### Customize PR Template
The script uses these sections from your docs:
- Overview
- Features Implemented
- PR Checklist
- Testing Instructions

Make sure your `PR-X-SUMMARY.md` files include these headings!

## Examples

### Example 1: Feature Branch with Docs

```bash
# On branch: feature/pr-4-shapes-sync
# Files: PR-4-SUMMARY.md, PR-4-IMPLEMENTATION.md

$ ./create-pr.sh

# Result:
# ✓ Finds PR-4-SUMMARY.md
# ✓ Extracts all sections
# ✓ Creates rich PR description
# ✓ Opens browser
```

### Example 2: Simple Feature Branch

```bash
# On branch: feature/fix-cursor-bug
# No docs

$ ./create-pr.sh

# Result:
# ⚠ No docs found
# ✓ Uses commit messages
# ✓ Creates basic PR
# ✓ Still works great!
```

### Example 3: Custom Base Branch

```bash
# Create PR against 'develop' branch
$ ./create-pr.sh develop

# Result:
# ✓ Compares against develop
# ✓ Creates PR to develop
```

## Benefits

### Before (Manual Process)
1. Push branch manually
2. Go to GitHub
3. Click "New Pull Request"
4. Copy-paste from documentation
5. Format markdown
6. Add sections manually
7. Submit PR
8. Navigate to PR to view

⏱️ **Time: 5-10 minutes**

### After (Automated Script)
1. Run `./create-pr.sh`
2. (Optional) Press 'y' to open browser

⏱️ **Time: 10 seconds**

## Pro Tips

### Tip 1: Set Up Alias
Add to `~/.zshrc`:
```bash
alias pr="~/Desktop/gauntlet-01/create-pr.sh"
```
Now just type `pr` anywhere!

### Tip 2: Document as You Code
Keep a `PR-X-SUMMARY.md` file updated as you work. The script will automatically use it!

### Tip 3: Include Checklists
Add a "PR Checklist" section to your docs - it'll show up in the PR automatically.

### Tip 4: Chain Commands
```bash
# Create PR and immediately view it
./create-pr.sh && gh pr view --web
```

## Advanced: Template Customization

Want to customize the PR template? Edit the "Generate PR Description" section (starting at line 240):

```bash
# Add your own sections:
{
    echo "## 🎯 Your Custom Section"
    echo "Your content here"
    echo ""
} >> "$PR_BODY_FILE"
```

## Integration with CI/CD

You can use this script in GitHub Actions:

```yaml
name: Auto-create PR
on:
  push:
    branches:
      - 'feature/**'

jobs:
  create-pr:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Create PR
        run: ./create-pr.sh
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

## Support

If you encounter issues:

1. Check GitHub CLI is installed: `gh --version`
2. Check authentication: `gh auth status`
3. Verify you're in a git repo: `git status`
4. Check branch has commits: `git log main..HEAD`

## Credits

Created to automate the beautiful PR workflow demonstrated in gauntlet-01. 

**The workflow:**
- 📊 Analyze commits and changes
- 📚 Find and read documentation
- ✍️ Generate comprehensive description
- 🚀 Push and create PR
- 🌐 Open in browser

All in one command! 🎉

---

**Happy PR-ing!** ✨

